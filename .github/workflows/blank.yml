name: Envoyer un fichier créé par GitHub Actions par e-mail

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout du code source
        uses: actions/checkout@v2

      - name: Créer le fichier
        run: echo "Contenu du fichier" > fichier.txt

      - name: Upload du fichier
        uses: actions/upload-artifact@v2
        with:
          name: fichier
          path: fichier.txt

      - name: Send email
        uses: devellany/send-mailer@v1.0.2
        with:
          host: smtp.google.com
          port: 465
          account: ${{secrets.ACCOUNT}}
          password: ${{secrets.MAIL_PASSWORD}}
          sender: devellany
          from: ${{secrets.MAIL_ADDRESS}}
          to: ibrahimaminianediouf@esp.sn
          subject: mail title.
          body: ceci est un test.
          contentType: text/plain
          attachments: '[{"path":"README.md"}]'
